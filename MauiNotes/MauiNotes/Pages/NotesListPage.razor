@page "/"
@page "/NotesList/{Type}"
@inject INotesService _notesService
@inject INoteReader _noteReader

<ion-header>
    <ion-toolbar color="primary">
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Notes List</ion-title>
    </ion-toolbar>
</ion-header>
<ion-grid fixed="true">
    <ion-row size="auto">
        <ion-col>
            <ion-label>Notes List</ion-label>
        </ion-col>
    </ion-row>
    <ion-row size="auto">
        <ion-col>
            <ion-label>Type: @Type</ion-label>
        </ion-col>
    </ion-row>
    <ion-row>
        <ion-col>
            <ion-list lines="none">
                @foreach (var item in _notes)
                {
                    <ion-item>
                        <ion-label class="ion-text-wrap">@item.NoteText</ion-label>
                        <ion-button slot="end" fill="clear" @onclick="() => Read_Text(item.NoteText)">Read Text</ion-button>
                    </ion-item>
                }
            </ion-list>
        </ion-col>
    </ion-row>
</ion-grid>

@code {
    [Parameter]
    public string Type { get; set; }

    private List<Note> _notes = new List<Note>();

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        if (Type == null)
        {
            Type = "Personal";
        }
        _notes = _notesService.GetNotes(Enum.Parse<NoteType>(Type));
    }

    async void Read_Text(string noteText)
    {
        await _noteReader.ReadNote(noteText);
    }

}